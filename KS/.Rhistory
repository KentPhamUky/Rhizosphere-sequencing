if (!require("BiocManager", quietly = TRUE))
install.packages("BiocManager")
BiocManager::install("phyloseq")
install_github("pmartinezarbizu/pairwiseAdonis/pairwiseAdonis")
install.packages("devtools")
library(devtools)
install_github("pmartinezarbizu/pairwiseAdonis/pairwiseAdonis")
library(ggplot2)
library(vegan)
library(plyr)
library(dplyr)
library(scales)
library(grid)
library(reshape2)
library(phyloseq)
library(microbiome)
library(pairwiseAdonis)
library(microbiome)
BiocManager::install("microbiome")
library(microbiome)
####Loading in####
#Plotting theme
theme_set(theme_bw())
sharedfile = "UK.final.opti_mcc.0.03.subsample.shared"
taxfile = "UK.final.opti_mcc.0.03.cons.taxonomy"
mapfile = "MetadataUK.csv"
mothur_data <- import_mothur(mothur_shared_file = sharedfile,
mothur_constaxonomy_file = taxfile)
# Import sample metadata
map <- read.csv(mapfile)
map = subset(map, Year == "3" | Year == "4")
map$Year <- as.factor(map$Year)
map <- sample_data(map)
# Assign rownames to be Sample ID's
rownames(map) <- map$group
moth_merge <- merge_phyloseq(mothur_data, map)
colnames(tax_table(moth_merge)) <- c("Kingdom", "Phylum", "Class",
"Order", "Family", "Genus")
Clean <- moth_merge %>%
subset_taxa(
Kingdom == "Bacteria" &
Family  != "mitochondria" &
Class   != "Chloroplast"
)
####Metadata####
#Not needed due to us subsampling-
# Make a data frame with a column for the read counts of each sample
sample_sum_df <- data.frame(sum = sample_sums(Clean))
ggplot(sample_sum_df, aes(x = sum)) +
geom_histogram(color = "black", fill = "indianred", binwidth = 100) +
ggtitle("Distribution of sample sequencing depth") +
xlab("Read counts") +
theme(axis.title.y = element_blank())
smin <- min(sample_sums(Clean))
smean <- mean(sample_sums(Clean))
smax <- max(sample_sums(Clean))
Clean <- moth_merge %>%
subset_taxa(
Kingdom == "Bacteria" &
Family  != "mitochondria" &
Class   != "Chloroplast"
)
library(phyloseq)
####Loading in####
#Plotting theme
theme_set(theme_bw())
sharedfile = "UK.final.opti_mcc.0.03.subsample.shared"
taxfile = "UK.final.opti_mcc.0.03.cons.taxonomy"
mapfile = "MetadataUK.csv"
mothur_data <- import_mothur(mothur_shared_file = sharedfile,
mothur_constaxonomy_file = taxfile)
sharedfile = "KS.final.opti_mcc.0.03.subsample.shared"
taxfile = "KS.final.opti_mcc.0.03.cons.taxonomy"
mapfile = "MetadataUK.csv"
mothur_data <- import_mothur(mothur_shared_file = sharedfile,
mothur_constaxonomy_file = taxfile)
mothur_data <- import_mothur(mothur_shared_file = sharedfile,
mothur_constaxonomy_file = taxfile)
